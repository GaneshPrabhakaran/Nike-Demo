var Cuke=(function(){var c="embed table ",d="raw",h="image",n="message",e="category",f="td[colspan]";var j="expanded",m="collapsed";var b="red",l="yellow",a="green";var i=function(o,p,q){$("<th />",{"class":o,text:q}).appendTo(p)};var k=function(o,q,p){console.log(p);var r=$("<td />",{"class":o}).appendTo(q);if(p){r.append($(p).children("a"))}};var g=function(o){return typeof(o)==="string"?$("#"+o):$(o)};return{fixupContents:function(p,o){p.each(function(){var q=$(this);var r="passed";if(q.hasClass(b)){r="failed"}if(q.hasClass(l)){r="skipped"}q.siblings(".comment,.tags-container").addClass(r).prependTo(q.siblings(".scenario-details"))});o.each(function(){$(this).prependTo($(this).parent())})},fixupExamples:function(q){if(q.is(":empty")){return q.remove()}var p=q.find("td."+n).length;var r=q.find("td."+e).length;var s=q.parent().children(".embed.image").length;var u=q.parent().children(".embed");var t=0;q.find(f).attr("colspan",6+(p?1:0)+(r?1:0)+(s?2:0)).parent().addClass("stack");var o=q.find("tr:first-child");if(p){i(n,o,n)}if(r){i(e,o,e)}i(c+d,o);i(c+d,o);if(s){i(c+h,o);i(c+h,o)}q.find("tr:not(:first-child,.stack)").each(function(){var v=$(this);if(p&&!v.children("."+n).length){k(n,v)}if(r&&!v.children("."+e).length){k(e,v)}k(c+d,v,u[t]);k(c+d,v,u[t+1]);t+=2;if($(u[t]).hasClass("image")){k(c+h,v,u[t]);k(c+h,v,u[t+1]);t+=2}else{if(s){k(c+h,v);k(c+h,v)}}});u.remove();q.find("a").attr({target:"_blank","data-for":null})},red:function(o){g(o).removeClass(a).removeClass(l).addClass(b)},yellow:function(o){g(o).removeClass(a).addClass(l)},loadFailed:function(o){$(o).addClass("load-failed")},toggle:function(o){return $(o).toggleClass(m).toggleClass(j)},expand:function(o){return $(o).removeClass(m).addClass(j)},collapse:function(o){return $(o).addClass(m).removeClass(j)},filter:function(o){if(o==="all"){return $(".feature,.scenario").show()}$(".feature").each(function(){var p=$(this);var q=p.children(".scenario");if(p.children(".tags-container").children(".tag").text().split("@").indexOf(o)!==-1){p.show();q.show()}else{q.each(function(){var r=$(this);if(r.find(".tag").text().split("@").indexOf(o)!==-1){r.show()}else{r.hide()}});if(q.filter(":visible").length!==0){p.show()}else{p.hide()}}})}}})();$(document).ready(function(){var b=250;var a=".scenario-details";$("img").error(function(){Cuke.loadFailed(this)});var h=$("#tag-filter");var c=$(".scenario-header");Cuke.fixupContents(c,$(".feature").children("h2,.tags-container").add($(".background").children("h3")));$("table.outline").each(function(){Cuke.fixupExamples($(this))});var g=$(".embed:not(.table)");var e=c.siblings(a);var j=$(".tag").text().split("@").sort();for(var d=1;d<j.length;d++){if(h.children('[value="'+j[d]+'"]').length===0){h.append($("<option/>",{text:"@"+j[d],value:j[d]}))}}h.change(function(){Cuke.filter($(this).val())});c.click(function(){var i=$(this);i.siblings(a).slideToggle(250);Cuke.toggle(i.parent())});$("#expander").click(function(){e.slideDown(b);Cuke.expand(c.parent())});$("#collapser").click(function(){e.slideUp(b);Cuke.collapse(c.parent())});$(".code-toggle").click(function(){Cuke.toggle(this).siblings(".code-container").slideToggle(b)});$("#failure-expander").click(function(){var i=c.filter(".red");i.siblings(a).slideDown(b);Cuke.expand(i.parent())});g.filter(".image").children("a").click(function(k){if(k.button===0){var i=$(this);var l=$(i.data("for"));if(l.children("img").hasClass("load-failed")){return true}$(i.data("for")).slideToggle(b);return false}});g.filter(".raw").children("a").click(function(l){if(l.button===0){var k=$(this);var m=$(k.data("for")).children("pre");var i=k.attr("href");$.ajax(i).fail(function(){window.open(i,"_blank")}).done(function(n){m.html(n).parent().slideToggle(250)});return false}});var f=$(".scenario.outline").find(".scenario-header");f.filter(".yellow").parent().find(".example").each(function(){var i=$(this);if(i.find(".step.undefined").length>0){Cuke.yellow(i.children("h3"))}});f.find(".red").parent().find(".example").each(function(){var i=$(this);if(i.find(".step.failed").length>0){Cuke.red(i.children("h3"))}})});